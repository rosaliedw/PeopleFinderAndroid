<link rel="import" href="/includes.html">

<dom-module id="person-details-page">

    <template>
        <style include="custom-styles">
            body {
                @apply --layout-inline;
                @apply --layout-center-center;
                @apply --layout-wrap;
                padding: 40px;
            }

            paper-header-panel {
                width: 100%;
                height: 100%;
                background-color: var(--paper-light-blue-900);
            }

            [slot=header] {
                height: auto;
                font-size: 28px;
                line-height: 60px;
                padding: 0 10px;
                color: white;
                transition: height 0.2s;
            }

            #backbutton {
                position: relative;
                float: left;
                margin-left: 0;
                margin-top: 5px;
            }


            .disabled {
                opacity: 0.5;
                pointer-events: none;
            }

            paper-input {
                padding-left: 10%;
                padding-right: 10%;
            }
        </style>


        <app-location route="{{route}}" query-params="{{queryParams}}"></app-location>
        <app-route route="{{route}}" pattern="/:view/:cn/:uid/:department/:title/:mobile/:mail/:preferredlanguage" data="{{routeData}}"
            tail="{{subroute}}"></app-rou te>
            <paper-header-panel mode="seamed">
                <div slot="header">
                    <paper-icon-button id="backbutton" icon="icons:arrow-back" on-tap="_goBack"></paper-icon-button>
                    <person-header-element cn="[[cn]]" uid="[[uid]]"></person-header-element>
                </div>
            </paper-header-panel>



            <paper-icon-item>
                <iron-icon icon="icons:work" slot="item-icon">
                </iron-icon>
                <paper-item-body two-line>
                    <div>[[department]], [[title]]</div>
                    <div secondary>Department and function</div>
                </paper-item-body>
            </paper-icon-item>


            <template is="dom-if" if="{{isPreferredLanguageSet}}">
                <paper-icon-item>
                    <iron-icon icon="icons:language" slot="item-icon">
                    </iron-icon>
                    <paper-item-body two-line>
                        <div>[[preferredlanguage]]</div>
                        <div secondary>Preferred language</div>
                    </paper-item-body>
                </paper-icon-item>
            </template>


            <div>
                <paper-icon-item on-tap="_makePhoneCall">

                    <iron-icon icon="communication:phone" slot="item-icon">
                    </iron-icon>
                    <paper-item-body two-line>
                        <paper-ripple></paper-ripple>
                        <div>[[mobile]]</div>
                        <div secondary>Mobile</div>
                    </paper-item-body>
                    <paper-icon-button on-tap="_sendSms" icon="communication:textsms">
                    </paper-icon-button>
                    </iron-icon>
                </paper-icon-item>
            </div>


            <paper-icon-item on-tap="_mailTo">
                <iron-icon icon="communication:email" slot="item-icon">
                </iron-icon>
                <paper-item-body two-line>
                    <paper-ripple></paper-ripple>
                    <div>[[mail]]</div>
                    <div secondary>Email</div>
                </paper-item-body>
            </paper-icon-item>

    </template>

    <script>
        class PersonDetailsPage extends Polymer.Element {
            static get is() { return 'person-details-page'; }
            static get properties() {
                return {
                    queryParams: {
                        type: Object,
                        observer: '_routeParamsChanged'
                    },
                    isPreferredLanguageSet: {
                        type: Boolean
                    }
                }
            }

            _routeParamsChanged(newValue) {
                for (var i in this.queryParams) {
                    this[i] = this.queryParams[i];
                }

                this.isPreferredLanguageSet = this.preferredlanguage === undefined ? false : true;

            }
            _goBack() {
                this.set('queryParams', {});
                this.set('route.path', '/search/');
                this.set('preferredlanguage', undefined);
            }

            _isDisabled(arg) {
                return arg === undefined ? 'disabled' : '';
            }

            _makePhoneCall() {
                window.location.assign(encodeURI('tel:' + this.mobile));
            }
            _sendSms(e) {
                e.stopPropagation();
                window.location.assign(encodeURI('sms:' + this.mobile));
            }
            _mailTo() {
                window.location.assign(encodeURI('mailto:' + this.mail));
            }
        }
        customElements.define(PersonDetailsPage.is, PersonDetailsPage);
    </script>

</dom-module>